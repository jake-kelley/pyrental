<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; connect-src 'self' https://cdn.jsdelivr.net;" />
    <title>Rent vs Sell Calculator</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1"
            integrity="sha384-jb8JQMbMoBUzgWatfe6COACi2ljcDdZQ2OxczGA3bGNeWe+6DChMTBJemed7ZnvJ"
            crossorigin="anonymous"></script>
  </head>
  <body>
    <noscript>
      <p style="text-align: center; padding: 2rem; color: #e4e4e4;">
        This calculator requires JavaScript to function. Please enable JavaScript in your browser.
      </p>
    </noscript>
    <!-- Mobile tooltip display (shown on input focus) -->
    <div id="mobileTooltip" class="mobile-tooltip" aria-live="polite" aria-atomic="true"></div>
    <div class="container">
      <h1>üè† Rent vs Sell Calculator</h1>
      <p class="subtitle">
        Compare the financial outcomes of renting vs selling your property
      </p>

      <div class="calculator-layout">
        <!-- Main Input Section -->
        <div class="input-section">
          <h2>Calculator Inputs</h2>
          
          <h3>Property Details</h3>
          <div class="subsection-inputs">

            <div class="input-group">
              <label for="purchasePrice" title="What you paid when you bought the home">Original Purchase Price ($)</label>
              <input type="number" id="purchasePrice" value="400000" min="0" step="1000" />
            </div>
            <div class="input-group">
              <label for="currentHomeValue" title="Today's market value. Used as Year 0 basis for appreciation.">Current Est. Home Value ($)</label>
              <input type="number" id="currentHomeValue" value="390000" min="0" step="1000" />
            </div>
            <div class="input-group">
              <label for="loanOriginDate" title="When your mortgage started. Used to calculate months paid.">Loan Origination Date</label>
              <input type="date" id="loanOriginDate" value="2023-01-01" />
            </div>
            <div class="input-group">
              <label for="originalLoanAmount" title="Initial loan principal (not current balance)">Original Loan Amount ($)</label>
              <input type="number" id="originalLoanAmount" value="320000" min="0" step="1000" />
            </div>
            <div class="input-group">
              <label for="interestRate" title="Annual interest rate on your mortgage">Interest Rate (%)</label>
              <input type="number" id="interestRate" value="6.5" min="0" max="30" step="0.125" />
            </div>
            <div class="input-group">
              <label for="mortgageTerm" title="Length of your mortgage (15, 20, or 30 years)">Mortgage Term (years)</label>
              <select id="mortgageTerm">
                <option value="15">15 years</option>
                <option value="20">20 years</option>
                <option value="30" selected>30 years</option>
              </select>
            </div>
            <div class="input-group hidden">
              <label for="monthlyPI" title="Auto-calculated from: Loan Amount + Interest Rate + Term">Monthly P&I Payment (calculated)</label>
              <input type="text" id="monthlyPI" value="$2,023" readonly class="calculated-field" />
            </div>
            <div class="input-group">
              <label for="primaryResidence" title="Have you used this property as your primary residence for 2 of the last 5 years? If yes, you may qualify for up to $500k capital gains exemption when selling">Primary Residence? (2/5)</label>
              <select id="primaryResidence">
                <option value="yes" selected>Yes</option>
                <option value="no">No</option>
              </select>
            </div>
            
            <div class="input-group">
              <label for="yearsToHold" title="Number of years to hold property to project and compare">Years to Hold</label>
              <input type="number" id="yearsToHold" value="10" min="1" max="30" />
            </div>
          </div>

          <hr class="section-divider">

          <h3>Monthly Costs</h3>
          <div class="subsection-inputs">
            <div class="input-group">
              <label for="monthlyHOA" title="Homeowners association fees">HOA ($)</label>
              <input type="number" id="monthlyHOA" value="200" min="0" step="10" />
            </div>
            <div class="input-group">
              <label for="monthlyTaxes" title="Property tax √∑ 12">Property Taxes ($)</label>
              <input type="number" id="monthlyTaxes" value="350" min="0" step="10" />
            </div>
            <div class="input-group">
              <label for="monthlyInsurance" title="Homeowners insurance √∑ 12">Home Insurance ($)</label>
              <input type="number" id="monthlyInsurance" value="150" min="0" step="10" />
            </div>
            <div class="input-group">
              <label for="monthlyMaintenance" title="Reserve for repairs (typically .5-1% of home value √∑ 12)">Maintenance Reserve ($)</label>
              <input type="number" id="monthlyMaintenance" value="300" min="0" step="10" />
            </div>
          </div>

          <hr class="section-divider">

          <h3>Rental Assumptions</h3>
          <div class="subsection-inputs">
            <div class="input-group">
              <label for="rentalPrice" title="Expected monthly rent you can charge">Monthly Rent ($)</label>
              <input type="number" id="rentalPrice" value="2500" min="0" step="50" />
            </div>
            <div class="input-group">
              <label for="annualRentIncrease" title="How much rent increases each year">Annual Rent Increase (%)</label>
              <input type="number" id="annualRentIncrease" value="3" min="0" max="20" step="0.5" />
            </div>
            <div class="input-group">
              <label for="propertyMgmtFee" title="% of rent paid to property manager (0 if self-managing)">Property Mgmt Fee (%)</label>
              <input type="number" id="propertyMgmtFee" value="8" min="0" max="100" step="1" />
            </div>
            <div class="input-group">
              <label for="rentalTaxRate" title="Your marginal tax rate on rental income">Tax Rate on Income (%)</label>
              <input type="number" id="rentalTaxRate" value="22" min="0" max="100" step="1" />
            </div>
          </div>

          <hr class="section-divider">

          <h3>Return, Fees, and Tax Assumptions</h3>
          <div class="subsection-inputs">
            <div class="input-group">
              <label for="homeAppreciation" title="Expected annual increase in home value">Home Appreciation (%)</label>
              <input type="number" id="homeAppreciation" value="2" min="-20" max="30" step="0.5" />
            </div>
            <div class="input-group">
              <label for="costInflation" title="Annual increase in property taxes, insurance, HOA (typically 2-4%)">Cost Inflation (%)</label>
              <input type="number" id="costInflation" value="3" min="0" max="20" step="0.5" />
            </div>
            <div class="input-group">
              <label for="sellingFees" title="Agent commission + closing costs (typically 5-6%)">Selling Fees (%)</label>
              <input type="number" id="sellingFees" value="6" min="0" max="100" step="0.5" />
            </div>
            <div class="input-group">
              <label for="capitalGainsTax" title="Tax rate on profit from sale (15-20% federal)">Capital Gains Tax Rate (%)</label>
              <input type="number" id="capitalGainsTax" value="20" min="0" max="100" step="1" />
            </div>
            <div class="input-group">
              <label for="investmentReturn" title="Expected return if you invest the sale proceeds">Investment Return (%)</label>
              <input type="number" id="investmentReturn" value="6" min="-50" max="50" step="0.5" />
            </div>
          </div>
        </div>

        <!-- Summary (sidebar) -->
        <div id="summary" class="summary vertical-summary"></div>
      </div>

      <!-- Chart -->
      <section class="chart-container" aria-labelledby="chart-heading">
        <h2 id="chart-heading">Comparison Over Time</h2>
        <canvas id="comparisonChart" role="img" aria-label="Line chart comparing rent vs sell financial outcomes over time"></canvas>
      </section>

      <!-- Results Table -->
      <section class="table-container" aria-labelledby="table-heading">
        <h2 id="table-heading">Year-by-Year Breakdown</h2>
        <table id="resultsTable" aria-label="Yearly financial breakdown comparing rent and sell scenarios">
          <thead>
            <tr>
              <th>Year</th>
              <th title="= Current value + annual appreciation">Home Value</th>
              <th title="Remaining mortgage balance">Loan Balance</th>
              <th title="= Home Value - Loan Balance">Equity</th>
              <th title="Estimated costs to sell (Agent fees + Closing costs)">Seller Fees</th>
              <th title="Estimated Capital Gains Tax">Capital Gains</th>
              <th title="Net proceeds after selling fees and capital gains tax&#10;&#10;= Sale Price - Loan - Fees - Taxes">Cash Out Value</th>
              <th title="Annual Profit/Loss from rental income&#10;&#10;= Rent - Expenses - Mgmt - Taxes">Annual Rent P/L</th>
              <th title="Cumulative Profit/Loss from rental income&#10;&#10;= Rent - Expenses - Mgmt - Taxes">Cumulative Rent P/L</th>
              <th title="Your total profit/loss if sold after the corresponding # of years&#10;&#10;= Cash Out Value + Cumulative Rent P/L">Cash Out + Rent P/L</th>
              <th title="Net proceeds from selling at Year 0, invested over time.&#10;&#10;If Year 0 proceeds are positive, they grow by the Investment Return %.&#10;If Year 0 proceeds are negative, the value remains constant.">Sell Now +<br />Invest Proceeds</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </div>

    <script src="calculator.js"></script>
  </body>
</html>
